!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).InfiniteAjaxScroll=e()}(this,(function(){"use strict";
/*! @license is-dom-node v1.0.4
		https://docs.infiniteajaxscroll.com/

	*/function t(t){return"object"==typeof window.Node?t instanceof window.Node:null!==t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName}

function e(e,n){if(void 0===n&&(n=document),e instanceof Array)return e.filter(t);if(t(e))return[e];if(o=Object.prototype.toString.call(i=e),"object"==typeof window.NodeList?i instanceof window.NodeList:null!==i&&"object"==typeof i&&"number"==typeof i.length&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(o)&&(0===i.length||t(i[0])))return Array.prototype.slice.call(e);var i,o;if("string"==typeof e)try{var r=n.querySelectorAll(e);return Array.prototype.slice.call(r)}catch(t){return[]}return[]}var n=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=Object.defineProperty,r=Object.getOwnPropertyDescriptor,s=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===i.call(t)},l=function(t){if(!t||"[object Object]"!==i.call(t))return!1;var e,o=n.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&n.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!o&&!r)return!1;for(e in t);return void 0===e||n.call(t,e)},a=function(t,e){o&&"__proto__"===e.name?o(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},c=function(t,e){if("__proto__"===e){if(!n.call(t,e))return;if(r)return r(t,e).value}return t[e]},u=function t(){var e,n,i,o,r,u,d=arguments,p=arguments[0],h=1,f=arguments.length,m=!1;for("boolean"==typeof p&&(m=p,p=arguments[1]||{},h=2),(null==p||"object"!=typeof p&&"function"!=typeof p)&&(p={});f>h;++h)if(null!=(e=d[h]))for(n in e)i=c(p,n),p!==(o=c(e,n))&&(m&&o&&(l(o)||(r=s(o)))?(r?(r=!1,u=i&&s(i)?i:[]):u=i&&l(i)?i:{},a(p,{name:n,newValue:t(m,u,o)})):void 0!==o&&a(p,{name:n,newValue:o}));return p},d="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},p="Expected a function",h=NaN,f="[object Symbol]",m=/^\s+|\s+$/g,y=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,v=/^0o[0-7]+$/i,b=parseInt,w="object"==typeof self&&self&&self.Object===Object&&self,x="object"==typeof d&&d&&d.Object===Object&&d||w||Function("return this")(),S=Object.prototype.toString,O=Math.max,j=Math.min,T=function(){return x.Date.now()};function C(t,e,n){var i,o,r,s,l,a,c=0,u=!1,d=!1,h=!0;if("function"!=typeof t)throw new TypeError(p);function f(e){var n=i,r=o;return i=o=void 0,c=e,s=t.apply(r,n)}function m(t){var n=t-a;return void 0===a||n>=e||0>n||d&&t-c>=r}function y(){var t=T();if(m(t))return g(t);l=setTimeout(y,function(t){var n=e-(t-a);return d?j(n,r-(t-c)):n}(t))}function g(t){return l=void 0,h&&i?f(t):(i=o=void 0,s)}function v(){var t=T(),n=m(t);if(i=arguments,o=this,a=t,n){if(void 0===l)return function(t){return c=t,l=setTimeout(y,e),u?f(t):s}(a);if(d)return l=setTimeout(y,e),f(a)}return void 0===l&&(l=setTimeout(y,e)),s}return e=L(e)||0,I(n)&&(u=!!n.leading,r=(d="maxWait"in n)?O(L(n.maxWait)||0,e):r,h="trailing"in n?!!n.trailing:h),v.cancel=function(){void 0!==l&&clearTimeout(l),c=0,i=a=o=l=void 0},v.flush=function(){return void 0===l?s:g(T())},v}function I(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function L(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&S.call(t)==f}(t))return h;if(I(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=I(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(m,"");var n=g.test(t);return n||v.test(t)?b(t.slice(2),n?2:8):y.test(t)?h:+t}var _=function(t,e,n){var i=!0,o=!0;if("function"!=typeof t)throw new TypeError(p);return I(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),C(t,e,{leading:i,maxWait:e,trailing:o})},E={item:void 0,next:void 0,pagination:void 0,responseType:"document",bind:!0,scrollContainer:window,spinner:!1,logger:!0,loadOnScroll:!0},P=function(t,n){var i=e(t);if(i.length>1)throw Error('Expected single element for "'+n+'"');if(0===i.length)throw Error('Element "'+t+'" not found for "'+n+'"')};function D(t){if(t!==window)return{x:t.scrollLeft,y:t.scrollTop};var e=void 0!==window.pageXOffset,n="CSS1Compat"===(document.compatMode||"");return{x:e?window.pageXOffset:n?document.documentElement.scrollLeft:document.body.scrollLeft,y:e?window.pageYOffset:n?document.documentElement.scrollTop:document.body.scrollTop}}function F(t){var e;if(t!==window)e=t.getBoundingClientRect();else{var n=document.documentElement,i=document.body;e={top:0,left:0,right:n.clientWidth||i.clientWidth,width:n.clientWidth||i.clientWidth,bottom:n.clientHeight||i.clientHeight,height:n.clientHeight||i.clientHeight}}return e}var H={y:0,x:0,deltaY:0,deltaX:0};function A(t,e){var n=D(t);return n.deltaY=n.y-(e?e.y:n.y),n.deltaX=n.x-(e?e.x:n.x),n}function N(){var t=this._lastScroll=A(this.scrollContainer,this._lastScroll||H);this.emitter.emit("scrolled",{scroll:t}),this.measure()}function R(){var t=this._lastScroll=A(this.scrollContainer,this._lastScroll||H);this.emitter.emit("resized",{scroll:t}),this.measure()}function B(){}B.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var i=this;function o(){i.off(t,o),e.apply(n,arguments)}return o._=e,this.on(t,o,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,o=n.length;o>i;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],o=[];if(i&&e)for(var r=0,s=i.length;s>r;r++)i[r].fn!==e&&i[r].fn._!==e&&o.push(i[r]);return o.length?n[t]=o:delete n[t],this}};var M=B;function q(t){var n=this,i=n._lastResponse||document,o=e(n.options.next,i)[0];if(o)return n.load(o.href).then((function(t){i=n._lastResponse=t.xhr.response;var o=e(n.options.next,i)[0];return n.append(t.items).then((function(){return!!o}))}))}M.TinyEmitter=B;var W={element:void 0,hide:!1};var X=function(t,e){this.options=u({},W,function(t){return"string"==typeof t?t={element:t,hide:!0}:"boolean"==typeof t&&(t={element:void 0,hide:t}),t}(e)),this.options.hide&&(P(this.options.element,"pagination.element"),t.on("binded",this.hide.bind(this)),t.on("unbinded",this.restore.bind(this)))};X.prototype.hide=function(){var t=e(this.options.element)[0];this.originalDisplayStyle=window.getComputedStyle(t).display,t.style.display="none"},X.prototype.restore=function(){e(this.options.element)[0].style.display=this.originalDisplayStyle};var z={element:void 0,delay:600,show:function(t){t.style.opacity="1"},hide:function(t){t.style.opacity="0"}};var k=function(t,n){!1!==n&&(this.ias=t,this.options=u({},z,function(t){return"string"==typeof t&&(t={element:t}),t}(n)),void 0!==this.options.element&&P(this.options.element,"spinner.element"),this.element=e(this.options.element)[0],this.hideFn=this.options.hide,this.showFn=this.options.show,t.on("binded",this.bind.bind(this)),t.on("binded",this.hide.bind(this)))};k.prototype.bind=function(){var t,e,n=this,i=this.ias;i.on("next",(function(){t=+new Date,n.show()})),i.on("last",(function(){n.hide()})),i.on("append",(function(i){e=Math.max(0,n.options.delay-(+new Date-t));var o=i.appendFn;i.appendFn=function(t,i,r){return new Promise((function(s){setTimeout((function(){Promise.resolve(n.hide()).then((function(){o(t,i,r),s()}))}),e)}))}}))},k.prototype.show=function(){return Promise.resolve(this.showFn(this.element))},k.prototype.hide=function(){return Promise.resolve(this.hideFn(this.element))};var $={hit:function(){console.log("Hit scroll threshold")},binded:function(){console.log("Binded event handlers")},unbinded:function(){console.log("Unbinded event handlers")},next:function(t){console.log("Next page triggered [pageIndex="+t.pageIndex+"]")},load:function(t){console.log("Start loading "+t.url)},loaded:function(){console.log("Finished loading")},append:function(){console.log("Start appending items")},appended:function(t){console.log("Finished appending "+t.items.length+" item(s)")},last:function(){console.log("No more pages left to load")},page:function(t){console.log("Page changed [pageIndex="+t.pageIndex+"]")}};var V=function(t,e){if(!1!==e){var n=function(t){return!0===t&&(t=$),t}(e);Object.keys(n).forEach((function(e){t.on(e,n[e])}))}};var Y=function(t){this.ias=t,this.pageBreaks=[],this.currentPageIndex=t.pageIndex,this.currentScrollTop=0,t.on("binded",this.binded.bind(this)),t.on("next",this.next.bind(this)),t.on("scrolled",this.scrolled.bind(this)),t.on("resized",this.scrolled.bind(this))};function G(t,e,n){var i=n?n.nextSibling:null,o=document.createDocumentFragment();t.forEach((function(t){o.appendChild(t)})),e.insertBefore(o,i)}Y.prototype.binded=function(){this.ias.sentinel()&&this.pageBreaks.push({pageIndex:this.currentPageIndex,url:""+document.location,title:document.title,sentinel:this.ias.sentinel()})},Y.prototype.next=function(t){var e,n,i=this,o=function(t){e=t.url,t.xhr.response&&(n=t.xhr.response.title)};this.ias.once("loaded",o),this.ias.once("appended",(function(){i.pageBreaks.push({pageIndex:t.pageIndex,url:e,title:n,sentinel:i.ias.sentinel()}),i.update(),i.ias.off("loaded",o)}))},Y.prototype.scrolled=function(t){this.update(t.scroll.y)},Y.prototype.update=function(t){this.currentScrollTop=t||this.currentScrollTop;var e=function(t,e,n){for(var i=e+F(n).height,o=t.length-1;o>=0;o--){if(i>t[o].sentinel.getBoundingClientRect().bottom+e)return t[Math.min(o+1,t.length-1)]}return t[0]}(this.pageBreaks,this.currentScrollTop,this.ias.scrollContainer);e&&e.pageIndex!==this.currentPageIndex&&(this.ias.emitter.emit("page",e),this.currentPageIndex=e.pageIndex)};var U=function(t,n){var i=this;void 0===n&&(n={}),P(t,"container"),this.container=e(t)[0],this.options=u({},E,n),this.emitter=new M,this.scrollContainer=this.options.scrollContainer,this.options.scrollContainer!==window&&(P(this.options.scrollContainer,"options.scrollContainer"),this.scrollContainer=e(this.options.scrollContainer)[0]),this.nextHandler=q,"function"==typeof this.options.next&&(this.nextHandler=this.options.next),this.binded=!1,this.paused=!1,this.loadOnScroll=this.options.loadOnScroll,this.pageIndex=this.sentinel()?0:-1,this.lastDistance=null,this.on("hit",(function(){i.loadOnScroll&&i.next()})),this.pagination=new X(this,this.options.pagination),this.spinner=new k(this,this.options.spinner),this.logger=new V(this,this.options.logger),this.paging=new Y(this),this.on("binded",this.measure),this.options.bind&&this.bind()};return U.prototype.bind=function(){this.binded||(this._scrollListener=_(N,200).bind(this),this._resizeListener=_(R,200).bind(this),this.scrollContainer.addEventListener("scroll",this._scrollListener),this.scrollContainer.addEventListener("resize",this._resizeListener),this.binded=!0,this.emitter.emit("binded"))},U.prototype.unbind=function(){this.binded&&(this.scrollContainer.removeEventListener("resize",this._resizeListener),this.scrollContainer.removeEventListener("scroll",this._scrollListener),this.binded=!1,this.emitter.emit("unbinded"))},U.prototype.next=function(){var t=this;this.pause();var e={pageIndex:this.pageIndex+1};this.emitter.emit("next",e),Promise.resolve(this.nextHandler(e.pageIndex)).then((function(n){t.pageIndex=e.pageIndex,n?t.resume():t.emitter.emit("last")}))},U.prototype.load=function(t){var n=this;return new Promise((function(i,o){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE)if(200===r.status){var s=r.response;"document"===n.options.responseType&&(s=e(n.options.item,r.response)),n.emitter.emit("loaded",{items:s,url:t,xhr:r}),i({items:s,url:t,xhr:r})}else console.error("Request failed"),o(r)};var s=t+(/\?/.test(t)?"&":"?")+(new Date).getTime();r.open("GET",s,!0),r.responseType=n.options.responseType,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.emitter.emit("load",{url:t,xhr:r}),r.send()}))},U.prototype.append=function(t,e){var n=this,i={items:t,parent:e=e||n.container,appendFn:G};n.emitter.emit("append",i);return new Promise((function(o){window.requestAnimationFrame((function(){Promise.resolve(i.appendFn(i.items,i.parent,n.sentinel())).then((function(){o({items:t,parent:e})}))}))})).then((function(t){n.emitter.emit("appended",t)}))},U.prototype.sentinel=function(){var t=e(this.options.item,this.container);return t.length?t[t.length-1]:null},U.prototype.pause=function(){this.paused=!0},U.prototype.resume=function(){this.paused=!1,this.measure()},U.prototype.enableLoadOnScroll=function(){this.loadOnScroll=!0},U.prototype.disableLoadOnScroll=function(){this.loadOnScroll=!1},U.prototype.measure=function(){if(!this.paused){var t,e,n,i,o,r=0,s=this.sentinel();s&&(t=s,n=D(e=this.scrollContainer),i=F(e),o=t.getBoundingClientRect(),r=n.y+o.bottom-i.top-(n.y+i.height)),r>0||null!==this.lastDistance&&0>=this.lastDistance||this.emitter.emit("hit",{distance:r}),this.lastDistance=r}},U.prototype.on=function(t,e){this.emitter.on(t,e,this),"binded"===t&&this.binded&&e.bind(this)()},U.prototype.off=function(t,e){this.emitter.off(t,e,this)},U.prototype.once=function(t,e){this.emitter.once(t,e,this),"binded"===t&&this.binded&&e.bind(this)()},U}));